## Упражнение 2 - Заигравка с данните

Вече имаме някакви данни в базата. Време е да се научим как да получаваме интересна информация от данните. Примерно по колко човека прознаваме от дадена категория. Това може да се постигне по два начина:

Вариант 1: Групиране и агрегиране;

    SELECT category, count(*) AS cnt 
    FROM chovek 
    GROUP BY category;

    category                     cnt       
    ---------------------------  ----------
    Приказен герой               2         
    Роднина                      1         

Заявката се "чете" по следния начин:

> Избери категория и броя редове за всяка категория от таблица **chovek** като групираш данните по категория.

SQL е много четим език, особено ако подбираме правилно имената на таблиците и колоните.

Интересното в резултата е че познаваме двама приказни герои и един роднина т.е. имаме социални проблеми и нужда от специализирана помощ.

Вариант 2: Вложени заявки (вложени селекти);

В този случай използването на вложени заявки е погрешно и ще забави излишно заявката но за пълнота на изложението ще го покажа тук:

    SELECT 
      c1.category, 
      (SELECT count(*) FROM chovek c2 WHERE c1.category = c2.category) AS cnt 
    FROM chovek c1 
    GROUP BY c1.category;

    category                     cnt       
    ---------------------------  ----------
    Приказен герой               2         
    Роднина                      1         

Доста по дълго и неприятно но все пак прочита е:

> Избери категория и за всяка категория преброй записите в таблицата за които имената на категориите са еднакви.

**c1** и **c2** се наричат псевдоними на таблиците (alias) а cnt се нарича псевдоним на колона (отново alias);

Резултатът от двете заявки е един и същ но е различен начинът по който те работят. Първата се изпълнява на един пас докато втората изпълнява външната заявка и за всеки резултатен ред от нея се изпълнява вътрешната заявка. Това е излишно в този случай и заявката освен по-дълга е и по-неефективна. Все пак има случаи в които вложените заявки ще ви бъдат от голяма полза.
